Evaluation of Assembly Strategies Using RNA-Seq Data
Associated with Grain Development of Wheat (Triticum
aestivum L.)
Huai-Zhu Li1., Xiang Gao1,2*, Xiao-Yan Li1,2*., Qi-Jiao Chen1,2, Jian Dong1,2, Wan-Chun Zhao1,2
1 Department of Seed Science, College of Agronomy, Northwest A&F University, Yangling, Shaanxi Province, People’s Republic of China, 2 Wheat Engineering Research
Center of Shaanxi Province, Yangling, Shaanxi Province, People’s Republic of China
      Abstract
      Wheat (Triticum aestivum L.) is one of the most important crops cultivated worldwide. Identifying the complete
      transcriptome of wheat grain could serve as foundation for further study of wheat seed development. However, the
      relatively large size and the polyploid complexity of the genome have been substantial barriers to molecular genetics and
      transcriptome analysis of wheat. Alternatively, RNA sequencing has provided some useful information about wheat genes.
      However, because of the large number of short reads generated by RNA sequencing, factors that are crucial to
      transcriptome assembly, including software, candidate parameters and assembly strategies, need to be optimized and
      evaluated for wheat data. In the present study, four cDNA libraries associated with wheat grain development were
      constructed and sequenced. A total of 14.17 Gb of high-quality reads were obtained and used to assess different assembly
      strategies. The most successful approach was to filter the reads with Q30 prior to de novo assembly using Trinity, merge the
      assembled contigs with genes available in wheat cDNA reference data sets, and combine the resulting assembly with an
      assembly from a reference-based strategy. Using this approach, a relatively accurate and nearly complete transcriptome
      associated with wheat grain development was obtained, suggesting that this is an effective strategy for generation of a
      high-quality transcriptome from RNA sequencing data.
   Citation: Li H-Z, Gao X, Li X-Y, Chen Q-J, Dong J, et al. (2013) Evaluation of Assembly Strategies Using RNA-Seq Data Associated with Grain Development of
   Wheat (Triticum aestivum L.). PLoS ONE 8(12): e83530. doi:10.1371/journal.pone.0083530
   Editor: Qiong Wu, Harbin Institute of Technology, China
   Received May 28, 2013; Accepted November 5, 2013; Published December 12, 2013
   Copyright: ß 2013 Li et al. This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted
   use, distribution, and reproduction in any medium, provided the original author and source are credited.
   Funding: This work was supported, in part, by the National Natural Science Foundation of China (31101138), Special Funds for Basic Research (QN2012003) and
   the Special Funds for Talents in Northwest A&F University (2010BSJJ033). The funders had no role in study design, data collection and analysis, decision to publish,
   or preparation of the manuscript.
   Competing Interests: The authors have declared that no competing interests exist.
   * E-mail: gx@nwsuaf.edu.cn (XG); xiaoyanli@nwsuaf.edu.cn (XYL)
   . These authors contributed equally to this work.
Introduction                                                                            by Sanger sequencing technologies [7,8]. Therefore, it is necessary
                                                                                        to reconstruct full-length transcripts from these short reads [16].
   Wheat (Triticum aestivum L.) is one of the most widely cultivated                    The short read assembly programs, SOAPdenovo-Trans [17],
crops because of its high yield and nutritional value [1,2,3].Wheat                     Trans-ABySS [18,19], Velvet-Oases [20,21] and Trinity [22] have
has a very large and complex genome (17Gb, 40 times larger than                         been successfully applied to assemble transcriptomes in many
Oryza sativa), which contains three homoeologous genomes                                organisms [10,22,23,24], with both the single k-mer (SK) and
(2n = AABBDD; AA from Triticum urartu, BB from a species that                           multiple k-mer (MK, not for Trinity) methods. Previous studies
is unknown but which maybe of the section Sitopsis,to which                             suggested that the specific characteristics of the different programs
Aegilops speltoides belongs, and DD from Aegilops Tauschii). Whole                      and strategies could greatly affect the assembly [22,25,26,27]. Of
genome sequencing of wheat has been considered too challenging                          the four programs, Trinity was the most efficient and sensitive in
because of the relatively large size, proportion of repeat sequences                    assembling full-length transcripts and isoforms in several model
(,80%, primarily retroelements) and number of paralogs and                              organisms [22], and it with the SK strategy outperformed Trans-
diverse alleles [1,4]. To date, no well-established wheat genome                        ABySS with the MK strategy in assembling a hexaploid wheat
sequence is available [5]. Transcriptome analysis could provide a                       transcriptome [6].
better understanding of wheat genetics, however, the relatively
                                                                                           Reference-based assembly strategies are often applied to
high proportion of orthologs, paralogs and isoforms in wheat and
                                                                                        reconstruct a transcriptome for which a reference genome is
the relatively low levels of gene expression also presents several
                                                                                        available [6,16]. However, this strategy is impractical for wheat,
unique challenges for transcriptome research [6]. RNA sequencing
                                                                                        which lacks a well-characterized genome. Fortunately, draft
(RNA-seq) with its unprecedented sensitivity and accuracy [7,8,9]
                                                                                        genomes of the wheat A and D-genome progenitors were recently
has been widely used for transcript profiling, Single nucleotide
                                                                                        established [28,29], which may serve as a good reference for wheat
polymorphism (SNP) detection and differentially expressed gene
                                                                                        short read assembly. On the other hand, de novo assembly of short
analysis [10,11,12,13,14,15]. Reads obtained using RNA-seq are
                                                                                        reads into a transcriptome can identify all transcripts, separate
often 35–500 bp, shorter than traditional expressed sequence tag
PLOS ONE | www.plosone.org                                                          1                          December 2013 | Volume 8 | Issue 12 | e83530
                                                                                               Evaluation of Assembly Strategies Using RNA-Seq
isoforms, and reconstruct full–length transcripts. However, de novo      Raw reads filtering
transcriptome assembly requires a much higher sequencing depth              Paired-end (PE) raw reads from the four libraries (EDAP4,E-
and ideal hardware than the reference-based strategy for the same        DAP8,EDAP12 and Mix) were trimmed using the
task. Furthermore, de novo transcriptome assembly programs are           NGSQCToolkit (version 2.2.3) without primer/adaptor filtering,
very sensitive to sequencing errors and fail to distinguish highly       with a read length cutoff of 50% and with a base Phred quality
similar transcripts (for example, alleles or paralogs) [16]. These       scores threshold of Q30 (P-value#0.001) [31]. The low-quality
observations suggested that a combinationof reference-based and          base calls at the ends of each read were filtered and reads that were
de novo strategies would be a superior approach that warranted           ,50 bp or singletons were discarded to generate the final high
testing in wheat.                                                        quality (HQ) read libraries. The data were deposited into SRA
   In the present study, sequence reads associated with grain            archive with accession number SRP029372.
development of wheat were obtained using RNA-seq. To
reconstruct an accurate and nearly complete transcriptome,               De novo assemble with four assemblers
several factors affecting read assembly were evaluated, including           To evaluate the performance of the four assembly programs, all
k-mer values, programs (SOAPdenovo, Trans-ABySS, Velvet-                 of the four read libraries HQ reads were de novo assembled using
Oases and Trinity), methods (SK or MK) and overall assembly              SOAPdenovo-Trans (release 1.01) with average insert size = 300
strategies were evaluated. Determining the best strategy for wheat       bp [17], Trans-ABySS (version 1.3.2) [19], Velvet (version 1.2.07)
transcriptome assembly from RNA-seq data could provide a                 with library insert length = 300 and minimum contig length =
crucial guideline for reconstruction of high quality transcriptomes      100 [20], Oases (version 0.2.08) [21], Trinity (release 20120608)
from complex genomes. In addition, the reconstructed transcrip-          with minimum contig length = 100 [22]. Similar assembly
tome from this study will be useful for future expression profiling      parameters were adopted in the four programs.
and differential expression analysis of genes associated with wheat         The k-mer length (k) is one of the most important parameters
grain development.                                                       because it defines the sequence overlap between two reads forming
                                                                         a contig and can substantively affect the final assembly product
Materials and Methods                                                    [19]. Shorter k values tend to be better for less expressed
                                                                         transcripts, whereas larger k values are more practical for highly
Plant materials and sampling                                             expressed sequences [20,32]. A single k-mer value is therefore
   The common wheat variety P271 was cultured during the wheat
                                                                         unlikely to yield an optimal overall assembly. Alternatively,
growing season (October to June) under natural conditions in
                                                                         compiling assemblies with multiple k-mer values improves
Yangling, Shaanxi province (34.26uN, 108.14uE), fertilized with
                                                                         accuracy, sensitivity, and specificity of the overall de novo
urea (60 kg/ha) and watered periodically. The mainstem ears were
                                                                         transcriptome assembly [19,32].
tagged on the morning when the anthers first appeared outside the
                                                                            SK and MK approaches were adopted in the SOAPdenovo-
florets of the spikelets. The labeled spikelets were harvested at 4, 8
                                                                         Trans, Trans-ABySS and Velvet-Oases assemblies. SK length
and 12 days after pollination (DAP4, DAP8 and DAP12).
                                                                         ranged from 25 to 97 bp with a length interval of 6. Only the SK
Developing grains were collected from the first florets of the four
                                                                         approach with k of 25 bp was used in the Trinity assembly. For the
central spikelets. The embryo of each grain was removed and the
                                                                         MK methods, Trans-ABySS merged all of the SK assemblies in
remaining endosperm and seed coat were designated as EDAP4,
                                                                         the first step of the analysis pipeline. Oases merged all of the
EDAP8 and EDAP12, respectively. Each group at this stage
                                                                         Velvet SK assemblies using an array of hash lengths and a
consisted of at least 200 seeds from 30 spikes, which were
                                                                         dynamic noise filtering process [21]. SOAPdenovo-Trans merged
immediately frozen in liquid nitrogen. All materials were stored at
                                                                         all the SK assemblies and then removed redundancy. For each
280uC until RNA extraction [30].
                                                                         assembly program, the performance at different SK lengths was
                                                                         compared, and the k-mer value of the best assembly was selected.
RNA isolation and library preparation                                    Next, the best SK assembly of each program was compared to the
   Total RNA samples from the three sample groups (EDAP4,                MK assembly for that program (Figure 1). To examine overlap/
EDAP8 and EDAP12) were isolated using the Trizol reagent                 similarity among the seven assemblies, pairwise alignment was
(Invitrogen) and then treated with Dnase I (Promega) at a                performed using the Basic Local Alignment Search Tool like
concentration of 1 U/mg. The Mix-RNA sample was composed                 (BLAST-Like) Alignment Tool (BLAT) [33]. Similarity was
of equal amounts of RNA from EDAP4, EDAP8 and EDAP12.                    defined as the percentage of the two assemblies with .95%
The quality and quantity of the RNA samples were examined                identity and .80% overlap.
using the Agilent 2100 Bioanalyzer (Agilent Technologies). The              All the assemblies were performed on a Linux server with an 80-
RNA samples were then purified using the TruSeq RNA Sample               core processor and 512 GB of memory. HQ transcripts over 300
Preparation Kit (Illunima). Briefly, the poly-A mRNA was purified        bp were used for the downstream analysis.
from 10 mg of total RNA using poly-T oligo-attached magnetic
beads. The mRNA was fragmented using divalent cations at 95uC.
                                                                         Assembly statistics metrics calculation
The fragmented RNA was used for the first and second strand
                                                                            To compare the assemblies generated by different programs and
cDNA synthesis. The cDNA fragments were end-repaired and
                                                                         methods, assembly statistics were calculated using the N50Stat.pl
ligated to adapters for PCR purification and enrichment to create
                                                                         tool of the NGSQCToolkit [31]. Statistics metrics used in this
the final cDNA libraries. The number of PCR cycles was
                                                                         study included the total number of sequences$300bp, the average,
minimized to avoid amplification bias. Fragments from 250 to
                                                                         median, and N50 sequence lengths, the guanine-cytosine (GC)
350 bp were selected by agarose gel purification to produce the
                                                                         content and the proportion of ambiguous base calls (Ns). N50 was
libraries for cluster generation and sequencing. Paired-end
                                                                         defined as the contig length where 50% of the assembly was
sequencing of the four cDNA libraries (EDAP4, EDAP8, EDAP12
                                                                         represented by contigs of this size or longer [34].
and Mix) was performed using the Illumina sequencing platform
(GAII).
PLOS ONE | www.plosone.org                                             2                      December 2013 | Volume 8 | Issue 12 | e83530
                                                                                                    Evaluation of Assembly Strategies Using RNA-Seq
Figure 1. Analysis process flow diagram. This analysis process mainly consisted of four steps: (1) evaluation of raw and HQ read assembly, with
HQ reads chosen as input for the next step; (2) evaluation of the performance of four assembler programs using SK and MK methods, with Trinity
selected for downstream analysis; (3) evaluation of different data volume assembly strategy; and (4) evaluation of two hybrid assembly strategies; (5)
evaluation of two combined assembly strategy.
doi:10.1371/journal.pone.0083530.g001
Mapping reads back to transcripts                                            This, and another reference dataset (TriallCDNA) containing
   Mapping reads back to transcripts is one of the most important            97481 sequences ranging from 100 to 10382 bp, representing
methods to assess assembly quality. To obtain reads mapped back              nearly all wheat genes [4], were used to assess the completeness,
to transcript (RMBT) values for each assembly, Bowtie (version               contiguity and accuracy of each of our assemblies. BLAT [33] with
0.12.7), with default parameters [35], was applied to map PE short           default parameters was applied to map each assembly to the
reads back to the assembled contigs. The mapping metrics                     reference sequences [16,36]. Completeness is the percentage of
included reads that aligned concordantly exactly 1 times (ACE1),             reference sequences for which .80% of the length is covered by
reads that aligned concordantly .1 times (AC.1), and the overall             assembled contigs. Contiguity is the percentage of complete
alignment rate (OAR).                                                        reference sequences for which .80% of the length is covered by a
                                                                             single assembled transcript. Accuracy is the percentage of the
Mapping assembly transcripts to reference genes                              assembly that shares $95% identity with the reference sequences.
   Criteria to comprehensively assess transcriptome assemblies has           Perfect accuracy is the reference sequences for which .80% of the
been difficult to establish and is still in development. Recent              length is covered by a single assembled transcript and shared
studies have reported several important evaluative metrics for both          $95% identity with the transcript.
simple and complex transcriptomes, including completeness (the                  To assess the new transcripts detection capability of each
degree to which the references gene is covered by the assembled              assembly program, we aligned each assembly to the reference
contigs), contiguity (the likelihood that a full-length transcript is        sequences using BLAST with the requirement of .100 bp match.
represented as a single contig) and accuracy (a measure of the               The number and percentage of assembled contigs that aligned to
correctness of an assembly) [16,36]. However, it is difficult to             the reference sequences with identity $95% or $70% were used
assess assembly quality by these metrics without a set of well-              for assessment.
established expressed reference transcripts that, ideally, includes
transcripts of varying length and expression levels [16]. For our            Different data assembly strategies
purposes, a full-length common wheat cDNA data set was                          Reconstruction of a comprehensive transcriptome from short
available (TriFLDB-6137, http://trifldb.psc.riken.jp/download.               reads involves many complex assembly issues. This study
pl) with perfect replacement for a reference transcript that                 compared several different data assembly strategies including
contains 6137 sequences ranging from 131 to 8930 bp (N50                     mixing of RNA samples (EDAP4, EDAP8, EDAP12, Mix-RNA),
length = 1996 bp and average sequence length = 1753 bp). The                 merging of reads from different libraries (EDAP4, EDAP8,
fact that the data set contains many long transcripts makes it               EDAP12, Mix-reads) and merging of single library assemblies
particularly useful in estimating contiguity and completeness [37].          then removal of redundancies (Mix-assembly). The quality of the
PLOS ONE | www.plosone.org                                                3                       December 2013 | Volume 8 | Issue 12 | e83530
                                                                                                Evaluation of Assembly Strategies Using RNA-Seq
output from the different strategies was measured by the total           impact on assembly quality statistical analysis, the paired t-test
number of sequences obtained, the average length of reads, the           method was used instead of analysis of variance (ANOVA) to
N50 length, and the ACE1, AC.1, and OAR values).                         assess the effect of Q30 on assembly quality. For the same reason,
                                                                         two-way ANOVA without replication was applied in the other
Hybrid assembly with wheat cDNA                                          statistical analyses.
   TriallCDNA data was used to improve assembly quality [4].
HQ reads were mapped to TriallCDNA using Bowtie2 with                    Effect of Q30 on assembly quality
default parameters [37]. The sequences of TriallCDNA which                  Four cDNA libraries (EDAP4, EDAP8, EDAP12 and Mix)
were mapped at least once by the HQ reads, were extracted and            associated with wheat grain development were constructed for PE
used to design the MappedTriallCDNA data set. The unmapped               sequencing. A total of 88.145 million 100 bp PE raw reads,
HQ reads were de novo assembled usingTrinity and then merged             representing 17.63 Gb, were generated (Table 1). After filtering of
with MappedTriallCDNA using CD-HIT-EST [38] with 100%                    low-quality bases (quality score,Q30), short reads (,50 bp) and
identity to generate an overall assembly. This strategy is termed        singletons, 70.864 million HQ PE reads remained for downstream
merging unmapped transcripts with TriallCDNA (MUTT).                     analyses. The proportion of HQ reads from the four libraries
Another strategy was to firstly de novo assemble the HQ reads,           varied from 77.22 to 83.35%, with an average of 79.19%.
then assemble the resulting transcripts with MappedTriallCDNA               Raw and HQ reads of the four libraries were de novo assembled
using CAP3 [39] with 50 bp overlat and share at least 98%                using Trinity [22] to assess the effect of sequencing errors on
identity. We termed this strategy assemble de novo transcripts with      assembly quality. T-test analysis indicated that the number of
TriallCDNA (ADTT).                                                       contigs $500bp) assembled from the HQ reads was significantly
                                                                         lower (P-value,0.05) than from the raw reads. However, the N50
Combined strategies                                                      and average sequence lengths were slightly higher for the HQ read
   To create an even more comprehensive transcriptome, we next           assembly (Table 2), indicating that the Q30 quality control results
combined the reference-based and de novo assembly approaches.            in longer and fewer transcripts.
This strategy brings together the high sensitivity of reference-based       RMBT results indicated that the Q30 quality control improved
assembly with the greater ability of de novo assembly to detect novel    assembly quality and mapping percentage. The total number of
transcripts [16]. Firstly, the HQ reads from the four libraries          HQ reads was 19.61% lower than raw reads, and the percentages
(EDAP4, EDAP8, EDAP12 and Mix) were assembled by Cufflinks               of reads that could be mapped back to the assembled contigs was
[40] using the draft A- and D-progenitor genomes as references           higher for the HQ reads, with ACE1, AC.1 and OAR 2.09, 1.22
[28,29,40]. The assemblies were then combined with the MUTT              and 1.96% higher for HQ than raw reads, respectively (Figure 2,
or ADTT assembly by CD-HIT-EST [38] with 95% identity to                 Table S1).
generate overall assemblies. These strategies termed combined               Assemblies from the raw and HQ reads were separately aligned
reference-based assembly with MUTT assembly (CMUTT) and                  against the wheat reference databases TriFLDB-6137 and
combined reference-based assembly with ADTT assembly                     TriallCDNA, using BLAT [33]. The completeness and contiguity
(CADTT), respectively.                                                   of the HQ read assemblies were lower than that for the raw read
                                                                         assemblies. In contrast, the accuracy of the HQ read assemblies
Final transcriptome assembly and annotation                              was much higher than the raw read assemblies, especially when
   Through a series of analyses, the best strategy was selected to       using TriallCDNA as the reference (Table 3).
assemble the wheat grain development transcriptome. The contigs
from the EDAP4, EDAP8, EDAP12 and Mix libraries assembled                Assembly performance of programs with SK vs. Mk
by CADTT strategy were merged and clustered by CD-HIT-EST                methods
with identity of 95%. To obtain annotation information about the            The HQ reads from the four libraries were then de novo
assembled transcript, the final transcriptome was aligned by             assembled using four different software programs and evaluated by
BLAST searched against the non-redundant protein sequence                assembly statistics. Two-way ANOVA showed that for some
database with default parameters.                                        programs, as k increased from 25 to 91 bp, the average contig
                                                                         length and N50 length gradually increased, peaked at a k = 61 bp
Statistical analysis                                                     for SOAPdenovo and at a k = 37 bp for Velvet, and then dropped
   All statistical analyses were performed by Excle (Microsoft). An      off sharply (Figure 3A, Tables S2 and S3). In contrast, the average
a value of 0.05 was used as the criterion for statistical significance   and N50 lengths in the ABySS assembly firstly decreased with k
                                                                         increase and then increased slightly. The corresponding SK peaks
Results                                                                  of each value metric were different, ranging from k of 25 to 61bp
                                                                         (Figure 3A, Table S4). The total number of sequences decreased
Overview of analysis                                                     from 62515 (at k = 43) to 280 (at k = 97), from 28792 (at k = 31)
   Raw RNA-seq data and Q30 filtered HQ data of four wheat               to 164 (at k = 97), and from 33698 (at k = 25) to 1070 (at k = 97)
developmental libraries were firstly de novo assembled using the         in the SOAPdenovo, Velvet and ABySS assemblies, respectively
Trinity assembler to assess the Q30 quality control effect on            (Tables S2 and S4). The percentage of Ns decreased with
assembly. Then four assembler programs and several different             increasing k in all three programs(Figure 3, Tables S2, S3 and S4).
assembly strategies were evaluated and compared using these data            Comprehensive comparison showed that SOAPdenovo and
to select the most accurate and comprehensive approach to re-            ABySS achieved the best results at k = 43, with more and longer
construct the wheat transcriptome (Figure 1). Assembly evaluation        transcripts, whereas Velvet produced better results at k = 37.
metrics included descriptive statistics, RMBT, novel gene detec-         Therefore, we compared the assemblies at these k values with the
tion capability and computing resource usage. The raw and HQ             Trinity assembly at k = 25. The comparison revealed that there
reads (Q30 filtered) from the four libraries were statistically          were no significant differences among the four programs with
analyzed separately. However, since there were large differences in      respect to total number of sequences. Trinity produced relatively
sequencing depth among the four libraries, and it has a profound         longer transcripts. However, compared with the SK method, the
PLOS ONE | www.plosone.org                                             4                       December 2013 | Volume 8 | Issue 12 | e83530
                                                                                                      Evaluation of Assembly Strategies Using RNA-Seq
  Table 1. Statistics of raw and HQ reads.
  Metrics                            EDAP4              EDAP8             EDAP12            Mix               Total             Average
  Number of raw reads                24863171           11317131          11964057          40001060          88145419
  GC content (%)                     41.83              46.23             45.39             53.1                                46.6375
  Gb                                 13.2               6                 6.4               22                47.6
  Number of HQa reads                19467396           8815361           9239158           33342047          70863962
  GC content (%)                     41.22              45.49             44.81             52.63                               45.18
  Gb                                 10.4               4.8               5                 17.8              38
  HQ reads proportion                78.30%             77.89%            77.22%            83.35%                              79.19%
  a
   Q30 filtered reads.
  doi:10.1371/journal.pone.0083530.t001
MK method could significantly increase the total number of                      assembly approach. Trinity had a consistently better performance
sequences (Figure 4A, Tables 4 and S5). Trinity assembly (SK)                   in all cases than other programs, especially in ACE1 and OAR,
obtained fewer and relatively longer transcripts to other three                 while the Trans-ABySS k43 was the worst in OAR
programs MK assembly (Figure 4A, Table S5). RMBT was an
important benchmark for evaluating the performance of each                      Program capability in ideal transcript assembly
assembler. Theoretically, the optimal program would have the                       Although assembly statistics and RMBT metrics could evaluate
highest RMBT percentage. We found that the RMBT percentage                      the performance of programs, the assessment was incomplete
of SK and MK (except for Trinity) assemblies of the four programs               without support of reference sequences. Seven assemblies from the
varied considerably. The proportion of ACE1 varied from 2.67%                   four programs were mapped against wheat reference sequence
(SOAP-Trans, k = 43) to 35.21% (Trinity, K = 25), the                           databases (TriFLDB-6137 and TriallCDNA) using BLAST to
proportion of AC.1 varied between 3.06% (ABySS, k = 43) and                     assess the assembly completeness, contiguity and accuracy. Two-
11.53% (SOAPdenovo, k = 43), and the OAR varied from                            way ANOVA indicated a significant improvement in the
10.63% (ABySS, k = 43) to 49.95% (Trinity, K = 25). Although                    completeness and contiguity when the MK strategy was applied
the MK assemblies produced more transcripts than SK methods,                    to each program (except for SOAPdenovo and Trinity).
the proportion of ACE1 was not significantly higher (P-value                    Compared with the SK strategy, the MK approach produced
.0.05). The proportion of AC.1 in the MK assemblies and the                     more total sequences, but the accuracy was not enhanced,
OAR were significantly higher than that in the SK assemblies
                                                                                especially in SOAP-Trans. For the SK assemblies, Trinity had
(Figure 4B, Table S6). The proportions [of AC.1] were 24.67%
                                                                                the best performance in terms of completeness and contiguity. The
for Trans-ABySS MK, 43.49% for Velvet-Oases MK and 35.58%
                                                                                Trans-ABySS assembly had the highest accuracy rate. However,
for SOAPdenovo-Trans MK (Figure 4B, Tables 4 and S6). MK
methods generated more transcripts and better alignment
proportions than SK methods (Figure 4B, Table S6), similar to
previous studies [22,25]. Comparison the Trinity(SK methods)
assembly to other three programs (MK methods) indicated that no
obvious differences for OAR. However, Trinity assembly was
significantly higher in ACE1 and lower in AC.1. The results
suggested more redundance in the other programs assemblies (MK
methods) (Figure 4B, Table S6). The perfect alignment achieved
by Trinity may be attributable to its conservative k-mer-based
  Table 2. Statistics of the Mix raw and HQ read assemblies.
                              MeanD-
  Metrics                     valuea       Sdb     t Stat     P-value Sig
  Total reads                 24320364     2039492 24.24      ,0.05   *
  Total sequences$300 bp      22742        2063    22.66      .0.05
  Total sequences$500 bp      21235        670     23.69      ,0.05   *
  Total bases                 –1521587     697164  –4.37      ,0.05   *
  Average sequence length     10.66        25.28   0.84       .0.05
                                                                                Figure 2. Comparison of raw and HQ read assembly by
  N50 length                  22.75        47.32   0.96       .0.05             mapping reads back to assembled contigs. Raw and HQ reads
  GC content OR (G + C)s      –0.01        0.00    –3.45      ,0.05   *         were mapped back to the raw readand HQ read assemblies (contigs
                                                                                .300 bp), respectively. The assessment metrics included ACE1 and
  a
   The difference between the raw and HQ read assemblies.                       AC.1 percentagesandOAR. Statistical analysis was performed using
  b
    Standard deviation.                                                         paired t-tests and P-valuesrefer todifferences between the two
  *Mean significant at 5% level.                                                assemblies.
  doi:10.1371/journal.pone.0083530.t002                                         doi:10.1371/journal.pone.0083530.g002
PLOS ONE | www.plosone.org                                                    5                      December 2013 | Volume 8 | Issue 12 | e83530
                                                                                                        Evaluation of Assembly Strategies Using RNA-Seq
  Table 3. Quality of assemblies mapped to wheat reference                        there was very little difference in accuracy among the assembly
  genes.                                                                          results of Trinity (k = 25), SOAP-Trans (k = 43), and Velvet-
                                                                                  Oases (k = 37) (Figure 4, Table 4 and Table S7).
                                                                                     To assess the detection capability for novel transcripts of the
                             Mean D-                                              four programs, seven assemblies were aligned to TriallCDNA
  Metrics                    valuee        Sdf      t Stat     P-value Sig        using BLAST. The highest numbers of reference sequences were
  Aligned to TriFLDB-6137
                                                                                  detected by Trinity (k = 25) and SOAPdenovo (k = 43) (Figure
                                                                                  4C). The percentages of alignments with identity .95% were
  Completenessa              21.88%        0.01     23.40      ,0.05     *
             b
                                                                                  59.18% for Trinity (k = 25) and 52.57% for SOAPdenovo (k =
  Contiguity                 21.41%        0.01     23.64      ,0.05     *        43). The MK strategy detected more reference sequences than the
  Perfect accuruacyc         21.38%        0.01     22.90      .0.05              SK strategy for the same program. However, the relatively
  Accuruacyd                 2.11%         0.01     3.86       ,0.05     *        increased number was very small compared to total assembly
  Aligned to TriallCDNA                                                           increased many times generated by MK method (Figure 4C, Table
  Completeness               21.14%        0.01     22.64      .0.05
                                                                                  S7). Trinity (SK methods) assembly could detected more
                                                                                  references than other three programs. Similarity analysis indicated
  Contiguity                 21.03%        0.01     23.40      ,0.05     *
                                                                                  that there were large differences among the seven assemblies. The
  Perfect accuracy           0.03%         0.01     0.09       .0.05              Trans-ABySS assembly had the most similarity with the other six
  Accuracy                   2.18%         0.01     4.30       ,0.05     *        assemblies, whereas the SOAPdenovo-Trans assembly had the
  a
                                                                                  least overlap. The results suggested that the Trans-ABySS
    Percentage of reference sequences covered by the assemblies ($80% of the
  length).                                                                        program had the most reliable performance (Figure 5, Table
  b
    Percentage of complete reference sequences covered by a single assembled      S8). Take together, compared other three programs MK method
  contig (80% of the length).                                                     to Trinity assembly, the Trinity could get relative fewer and lower
  c
    Percentages of reference sequences covered by a single assembled contig       redundancy transcripts. But these transcripts with significantly
  (80%) that share $95% identity with the contig.
  d
    Percentage of assembled contigs that share $95% identity with the reference   higher ACE1, lower AC.1 and more identity with reference
  sequences.                                                                      sequences.
  e
    The mean difference between the HQ and raw read assemblies.
  f
    Standard deviation.
  *Mean significant at 5% level.
  doi:10.1371/journal.pone.0083530.t003
Figure 3. Performance of three programs using the SK method. The statistics of HQ read assembly by SOAPdenovo (red), Velvet (blue) and
ABySS (green) with different single k-mer lengths (x axis). Assembly statistics metrics included the average contig length (squares), the N50 length
(triangles), total sequences (circles) and percentage of Ns (stars).
doi:10.1371/journal.pone.0083530.g003
PLOS ONE | www.plosone.org                                                      6                     December 2013 | Volume 8 | Issue 12 | e83530
                                                                                                                 Evaluation of Assembly Strategies Using RNA-Seq
  Table 4. Evaluation of quality of assemblies from the four programs by BLAST alignment with wheat reference genes.
                                  Completeness                               Contiguity                                   Accuracy
  Programs                        Mean           Sd             Sig 5%*      Mean             Sd             Sig 5%*      Mean        Sd           Sig 5%*
  TriFLDB-6137
  Trinity k25                     36.99%         18.42%         a            27.71%           12.61%         ab           32.65%      10.20%       cd
  Velvet k37                      25.14%         19.30%         b            19.76%           18.92%         abc          36.11%      11.13%       c
  ABySS k43                       14.01%         8.23%          c            7.50%            2.44%          c            52.47%      2.38%        a
  SOAPdenovo k43                  14.51%         23.79%         c            15.67%           26.13%         bc           33.02%      9.13%        cd
  Velvet-Oases                    34.76%         20.10%         a            31.77%           18.21%         a            30.01%      6.88%        d
  Trans-ABySS                     38.78%         18.92%         a            24.89%           10.12%         ab           44.43%      2.72%        b
  SOAPdenovo-Trans                42.26%         24.06%         a            15.04%           28.94%         bc           23.89%      7.89%        e
  TriallCDNA
  Trinity k25                     33.16%         15.26%         ab           25.88%           12.19%         a            37.44%      12.84%       cd
  Velvet k37                      21.55%         16.17%         c            18.79%           14.19%         ab           42.99%      15.53%       bc
  ABySS k43                       15.16%         9.27%          d            10.65%           5.34%          b            54.66%      5.22%        a
  SOAPdenovo k43                  14.89%         20.11%         d            15.07%           21.05%         b            35.70%      9.40%        d
  Velvet-Oases                    29.59%         16.82%         b            27.32%           15.99%         a            33.39%      9.74%        d
  Trans-ABySS                     34.18%         16.09%         ab           27.56%           12.63%         a            47.03%      5.30%        b
  SOAPdenovo-Trans                38.50%         19.97%         a            13.08%           25.28%         b            33.65%      10.46%       d
  Assembled contigs and reference sequences ,300bp were excluded from all assemblies.
  *Different lower case letters within this column indicate that the means were significantly different at the 5% level.
  doi:10.1371/journal.pone.0083530.t004
Different data volume assembly strategies                                              (Mix-RNA, Mix-read, Mix-assembly), there was little difference in
   Analysis of assemblies constructed from different amounts and                       the OAR among the three assemblies (Figure 6, Tables S9 and
variety of starting sequence data showed that, compared with the                       S10). However, compared with the other two strategies, the Mix-
Mix-RNA strategy, the total reads resulting from the Mix-reads                         assembly strategy assembled a larger number of contigs. The
and Mix-assembly approaches were 12.54%, with 4179868 reads,                           percentage of AC.1 was high for this strategy and ACE1 was very
however, the total numbers of contigs of the assemblies were                           low, indicating that there was a high degree of redundancy. There
22.46% (15636) and 49.6% (34532), respectively. Although the                           was little difference in the mapping metrics between the Mix-RNA
total number of contigs was increased, the average and N50                             and Mix-reads assemblies, but the ACE1 percentage and OAR
lengths for the Mix-assembly approach were less than for the Mix-                      were increased relative to the Mix-assembly approach, indicating
RNA approach. When the Mix-HQ-reads and Mix-EDAP-reads                                 that the Mix-RNA strategy could obtain ideal transcripts. The
were mapped back to the assemblies from the three approaches                           RAM requirement and runtime for the Mix-RNA and Mix-reads
Figure 4. Performance of four programs and SK and MK strategies. Performance measures evaluated included assembly descriptive statistics
(A), RMBT percentage (B) and match with wheat reference genes (C). Lower case letters indicate significant differences (at 5% level) among the means
for the different programs of the same-colored bars.
doi:10.1371/journal.pone.0083530.g004
PLOS ONE | www.plosone.org                                                         7                            December 2013 | Volume 8 | Issue 12 | e83530
                                                                                              Evaluation of Assembly Strategies Using RNA-Seq
Figure 5. Similarity among the seven assemblies. Pairwise comparison among seven assemblies. Row and column intersections indicated that
the two assemblies were more similar.
doi:10.1371/journal.pone.0083530.g005
strategies were similar, but the Mix-assembly approach used the
least amount of RAM and runtime (Figure 6C). When the Mix-
EDAP-reads were used for mapping, the results were very similar,
but the proportion of alignment was greatly reduced (Figure 6,
Table S10 and S11).
Hybrid assembly with wheat cDNA
   TriallCDNA represents nearly all of the wheat genes [4]. To
assess the effect of incorporating TriallCDNA into the wheat
transcriptome assembly, HQ reads from the four libraries were
mapped to TriallCDNA. The distribution of mapped reads
showed that the reads that mapped to the reference ,4 times
accounted for 39.86% of the total reads (Figure 7, Table S12).
   Two hybrid assembly strategies, MUTT and ADTT, were
assessed by two-way ANOVA. MUTT generated 81506 assem-
bled sequences with an average length of 1058 bp. ADTT
generated 77531 assembled sequences with an average length of
1030 bp (Table 5). In contrast, de novo assembly generated 40519
sequences with an average length of 816 bp, indicating that the
hybrid strategies produce more and longer contigs. RMBT results
showed that the MUTT and ADTT strategies had significantly
                                                                       Figure 7. Distribution of HQ reads mapped to TriallCDNA. HQ
lower proportions of ACE1, higher proportions of AC.1, and             reads from the four libraries were aligned to the TriallCDNA reference
higher OARs than the de novo assembly. Overall, there were no          set. Shown is the percentage of mapped reads (y axis) vs. copies (x axis).
significant differences between the two hybrid strategies (Table 5).   doi:10.1371/journal.pone.0083530.g007
Combined assembly with the wheat A- and D-genome                       progenitor T. urartu and D-genome progenitor A.tauschiias refer-
progenitors                                                            ences. Two-way ANOVA indicated that all of the assessment
   Combined strategies were applied to assemble reads from the         metrics were significantly higher for the combined strategies
four libraries using the draft genomes of the wheat A-genome           (CMUTT and CADTT) compared to the de novo assembly. The
Figure 6. Performance of three assemble strategies. The performance was evaluated by (A) assembly descriptive statistics, (B) RMBT
proportion, and (C) longest runtime and largest RAM usage.
doi:10.1371/journal.pone.0083530.g006
PLOS ONE | www.plosone.org                                           8                      December 2013 | Volume 8 | Issue 12 | e83530
                                                                                                                 Evaluation of Assembly Strategies Using RNA-Seq
  Table 5. Statistics of de novo, MUTT, ADTT, CMUTT and CADTT assemblies.
  Metrics                      De novo                       MUTT                        ADTT                       CMUTT                 CADTT
                               Mean            Sig 5%*       Mean         Sig 5%*        Mean           Sig 5%*     Mean        Sig 5%*   Mean        Sig 5%*
  Number of sequences          45019           c             58537        b              64926          b           75526       a         80,495      a
  Average length               816             b             989          a              1011           a           1059        a         1061        a
  N50 length                   1035            b             1279         a              1330           a           1348        a         1369        a
  AC$1a                        44.20%          b             47.64%       a              48.51%         a           50.02%      a         50.44%      a
  OARb                         49.95%          b             53.29%       a              53.88%         a           54.79%      a         55.11%      a
  a
   Aligned concordantly $1 time is a combination of ‘‘ACE1’’ and ‘‘AC.1’’.
  b
    Overall alignment rate.
  *Different lower case letters within this column indicates that the means were significantly different at the 5% level.
  doi:10.1371/journal.pone.0083530.t005
total number of sequences increased from 45,019 for the de novo                        GC-content bias leads to more accurate estimates of fold changes
assembly to 75526 (CMUTT) and 80495 (CADTT). The average                               in expression [43]. The present study revealed that Q30 filtering
contigs and N50 lengths were increased .200bp and the RMBT                             could reduce the GC bias and improve assembly quality (Table
increased by an average of 5% (Table 5 and S13). Compared to                           S1).
the MUTT and ADTT strategies, CMUTT and CADTT
increased the number of contigs significantly, whereas the other                       Program performance
metrics, including length and RMBT, were not obviously                                    Trinity, SOAPdenovo-Trans, Trans-ABySS and Velvet-Oases
improved.                                                                              were developed specifically for RNA-seq assembly, and have been
                                                                                       applied successfully in many previous studies [10,19,23,24,44].
Final transcriptome assembly and annotation                                            Other recent studies have compared the performance of these four
    A final comprehensive transcriptome was generated using what                       assemblers using both SK and MK methods [22,25]. However,
this study determined to be best program (Trinity) and the best                        test data for this comparison was from species with relatively small,
strategy (CADTT) for our data. A total of 127083 sequences were                        simple, and well-characterized genomes (Drosophila melanogaster,
generated with an average length of 991 bp and N50 length of                           Shizosaccharomyces pombe, and the tea plant, Camellia sinensis). The
1353 bp. BLAST alignment to NR database showed that                                    length of D. melanogaster genome is ,122Mb with ,17,000 genes.
90935(,71.56%) of the assembled contigs were annotated (Table                          The length of genome of S. pombe is ,12Mb with ,5000 genes.
S14).                                                                                  The length of diploid C. sinensis genome is ,4 Gb [45]. Therefore,
                                                                                       the conclusion from these previous assembler assessments may not
Discussion                                                                             apply to all situations, especially to wheat, with its relatively large
                                                                                       (17Gb), complex allohexaploid genome and abundance of
Q30 quality control is necessary                                                       repetitive elements. Duan et al. (2012) optimized de novo assembly
    In general, RNA-seq data contains large numbers of low quality                     of a common wheat transcriptome from RNA-seq data. However,
reads, which originated during library preparation and the                             this work focused only on the Trinity (SK) and Trans-ABySS (MK)
sequencing process. Although variation in the amount of DNA                            programs. The lack of comparison to other programs, and
contamination, in the composition of sequencing kits, and in PCR                       consideration of hardware requirements, and statistical analysis
parameters can induce sequencing errors, PCR is the most likely to                     of results in that study maybe limited for the reliability of their
produce bias [41]. Therefore, maximal initial mRNA amounts                             program select in.
and minimal PCR cycle numbers were used to reduce potential                               The statistical analyses in the present study indicated that the
bias in the present study. Poor quality reads could lead to                            quality of transcriptome assembly was highly dependent on the
fragmented assemblies or false transcripts. Therefore, filtering low                   user-defined k-mer length. The lower the k-mer length, the more
quality reads pre-assembly could improve the accuracy and the                          transcripts were assembled, although k-mer length did not affect
length of contigs. Conventional quality control threshold are Q13                      transcript length. The optimal k-mer length for a given data set
or Q20, however, comprehensive comparison showed that use of a                         was associated with the sequencing depth, the base call error rate,
more stringent quality control threshold (Q30) filtered a large                        and the complexity of the organism from which the transcriptome
number of sequences, but greatly improved the assembly quality.                        is being constructed. Higher sequencing depth captures more
    The GC content of the raw and HQ reads in this study ranged                        weakly expressed gene. Base call error interrupts contigs, leading
from 41.83 to 53.1% and from 41.22 to 52.63%, respectively. The                        to more and shorter transcripts and, consequently, HQ reads
difference suggested that there may be a bias in coverage between                      generate longer contigs. Genome characteristics need to be
the different libraries (Table 1). The bias could be introduced at                     carefully considered, especially for a relatively complex genome
several stages of the standard Illumina sequencing process. For                        like wheat. Longer k-mer length would theoretically lead to a more
example, high cluster densities in the Illumina flow-cell can                          contiguous assembly of highly expressed transcripts [18], but more
suppress GC-rich reads [41]. However, this bias gave us the                            moderately expressed transcripts would be better assembled with
opportunity to study the effect of GC content on assembly quality,                     lower k-mer length [20].
and we found that low GC content in the library leads to more and                         The performance of SOAPdenovo-Trans, Velvet-Oases, and
shorter assembled sequences (EDAP4; Tables 1 and S1). The GC-                          Trans-ABySS was far superior to the SK-based versions of these
content bias describes the dependence of read coverage on                              programs, especially in terms of AC.1 and OAR [25]. Trinity
sequencing data [42]. Previous studies have found that reducing                        outperformed the other three programs using SK methods in all of
PLOS ONE | www.plosone.org                                                         9                            December 2013 | Volume 8 | Issue 12 | e83530
                                                                                              Evaluation of Assembly Strategies Using RNA-Seq
metrics. Therefore, assembly could be further improved if an MK         the two hybrid assemblies (MUTT and ADTT) significantly
strategy was applied in Trinity. However, the application was           improved the assembly quality in terms of both statistics and
limited due to its long runtime and fixed k-mer length, and the         RMBT (OAR = 53.9%). In addition, removal of contigs ,300 bp
current version of Trinity would be impractical.                        allowed more reads to be mapped back to the assemblies. The
   Trinity also outperformed the MK assemblies of the other             ideal RMBT metrics for the Mix sample indicated that a credible
programs. Compared to the three MK assemblies, Trinity (SK)             wheat grain development transcriptome was assembled.
assembled fewer total sequences with lower redundancy and
longer transcripts, but with nearly equal OAR (Figure 4A,B),            Combined strategy
similar to what was observed by Duan et al [6]. Performances of            Reference-based assembly is the ideal strategy for transcriptome
other programs with MK strategy were not satisfactory given the         reconstruct. The lack of a well-established full wheat genome
number of low quality assembled transcripts and more redun-             sequence makes reference-based assembly impractical. De novo
dance.                                                                  assembly of the wheat transcriptome can reconstruct full-length
   The amount of sequencing data from the Illumina platform is          transcripts, detect novel transcripts and achieve reasonable results
often very large. Velvet-Oases required the most memory, and            [6]. However, this methods lack of the genome and gene structure
Trinity required a runtime .20 fold longer than the other               information. Also, it can not distinguish the paralogs and alleles.
programs. Alternatively, the programs Trans-ABySS and SOAP-             The draft genomes of the wheat A- and D-genome progenitors
denovo-Trans required less memory and had shorter runtime.              provided the opportunity for reference-based assembly [28,29].
Taken together, our results indicated that the program used has
                                                                        Unfortunately, the reference is still incomplete because the B-
great effect on assembly outcome.
                                                                        genome sequence is not available. Combining reference-based and
                                                                        de novo assembly strategies can bring together the advantages of
Data volume may determine assembly strategies                           these two complementary approaches and create a more
   With the rapid decline in the cost of sequencing, a large amount     comprehensive transcriptome [16], as we found in this study (with
of wheat RNA-seq data from various tissues and developmental            both CMUTT and CADTT). Slight difference between the two
stages has become available. To effectively use this data, it is        combined strategies (CMUTT and CADTT) showed that all of
necessary to choose a suitable assembly strategy based on the           these two strategies could get ideal assmebly. Substantial increase
sequence volume and hardware requirements. An appropriate               in total assembled sequences and the smaller increase in RMBT
assembly strategy could improve transcriptome coverage and              indicated that more alleles and paralogous genes were assembled
accuracy, and save time and money.
                                                                        by the combined process.
   The Mix-RNA and Mix-read assembly strategies produced
good RMBT values, but because of the large amounts of data
generated by these strategies, the computing requirements and           Evaluation metrics
runtime (weeks or even months) may be prohibitive to many                  It is difficult to comprehensively evaluate assembly quality
researchers. Mix-RNA improved the detection of less highly              because assembly statistics tend to emphasize coverage and contig
expressed transcripts because of the increased sequencing depth         length rather than accuracy. Many criteria for systematically
and uniformity in transcript level produced by mixing equal             assessing assembly quality have been established [16,36], but these
amounts of RNA from the different samples. The Mix-read                 standards are only applicable to a simple transcriptome. The
strategy can also improve uniformity of transcripts because it          TriFLDB-6137 data set was a particularly useful reference for
involves a mix of samples from different development stages or          estimating the completeness, contiguity and accuracy of our
tissues. Therefore, both strategies could improve the assembly          assemblies. For wheat transcriptome assembly, it is necessary to
quality. The strength of the Mix-assembly strategy is that it has       identify orthologous genes in the A, B and D subgenomes, paralogs
relatively low computer hardware requirements and can be                and alleles. This auxiliary data set (including 51 WRKY
performed in less time. However, owing to lower sequencing              transcription factors and 23 orthologous gene groups from the
depth, a large number of transcripts could not be detected or           A, B, and D subgenomes) has been used as a reference to assess
assembled. Greater sequencing depth in the individual libraries         redundancy parameters [6]. Removing the majority of this
could potentially alleviate this issue. Although the test data was      redundancy from the primary library improved assembly quality
from the same experiment and the same species in this study, the        [6]. Therefore, a large well-characterized reference set that
strategies had universality and could be extended to species which      includes transcripts of variable length and expression levels,
have smaller differences on evolution, theoretically. Overall, Mix-     orthologs, paralogs, and multiple alleles needs to be collected to
RNA and Mix-read are the best strategy when computing                   assess assembly chimerism metrics and variant resolution. The
capabilities are not a limitation, whereas the Mix-assembly             current assessment methods and datasets are insufficient for
strategy maybe more practical for many researchers.                     constructing a wheat transcriptome and new evaluation metrics
                                                                        and algorithm are still needed.
Improving assembly quality using public databases                          In conclusion, deep sequencing and stringent quality control
   In the present study, stringent quality control and an optimized     together with the Trinity SK program and CADTT strategy
assembly program were applied to reconstruct a wheat grain              enabled reconstruction of a relatively accurate and essentially
development transcriptome. However, many genes were not                 complete transcriptome associated with wheat grain development.
detected or assembled because of insufficient sequencing depth.         These studies could provide aguidance strategy for future wheat
Supplementing our data with TriallCDNA improved the tran-               transcriptome assembly using RNA-seq data.
scriptome quality, but 53.2% of our HQ reads mapped to
TriallCDNA ,11 times (Figure 7, Table S12), and therefore it            Data Access
would not, theoretically, be assembled into full-length transcripts.
Even though the contig length threshold was set to 300 bp, there           The sequence data from this study have been submitted to the
were still many (39.86%) reads that were difficult to assemble          NCBI Sequence Read Archive (SRA)(http://www.ncbi.nlm.nih.
because they appeared ,4 times. Compared with de novo assembly,         gov/sra), with accession number is SRP029372.
PLOS ONE | www.plosone.org                                           10                      December 2013 | Volume 8 | Issue 12 | e83530
                                                                                                                     Evaluation of Assembly Strategies Using RNA-Seq
Supporting Information                                                                     Table S9 Statistics of single library assembly and
                                                                                           merged single assembly.
Table S1 Comparison between raw and HQ reads                                               (XLSX)
assemblies by paired t-test analysis.
(XLSX)                                                                                     Table S10         Statistics of three strategies assembly.
                                                                                           (XLSX)
Table S2 SOAPdenovo-Trans assembly.
(XLSX)                                                                                     Table S11         Comparison of three assemble strategies by
                                                                                           mapping.
Table S3 Velvet-Oases assembly.
                                                                                           (XLSX)
(XLSX)
                                                                                           Table S12 Distribution of Mix HQ map to TriallcDNA
Table S4 Trans-ABySS assembly.
(XLSX)                                                                                     assemblies.
                                                                                           (XLSX)
Table S5 Comparison of assembly quality among the
four programs with SK and MK methods.                                                      Table S13 Statistics of MUTT, ADTT, CMUTT and
(XLSX)                                                                                     CADTT assemblies.
                                                                                           (XLSX)
Table S6         Comparison of four progrmas assemblies
with SK and MK methods by mapping.                                                         Table S14         Transcriptome annotation and statistics.
(XLSX)                                                                                     (XLSX)
Table S7 Statistics of four programs assemblies aligned
to TriallCDNA.
                                                                                           Author Contributions
(XLSX)                                                                                     Conceived and designed the experiments: XYL XG. Performed the
                                                                                           experiments: HZL XYL. Analyzed the data: HZL QJC JD WCZ.
Table S8 Statistics of similarity among the seven                                          Contributed reagents/materials/analysis tools: HZL QJC XYL. Wrote the
assemblies.                                                                                paper: HZL XYL.
(XLSX)
References
 1. Choulet F, Wicker T, Rustenholz C, Paux E, Salse J, et al. (2010) Megabase             19. Robertson G, Schein J, Chiu R, Corbett R, Field M, et al. (2010) De novo
    Level Sequencing Reveals Contrasted Organization and Evolution Patterns of                 assembly and analysis of RNA-seq data. Nature Methods 7: 909–912.
    the Wheat Gene and Transposable Element Spaces. The Plant Cell 22: 1686–               20. Zerbino DR, Birney E (2008) Velvet: Algorithms for de novo short read
    1701.                                                                                      assembly using de Bruijn graphs. Genome Research 18: 821–829.
 2. Paux E, Sourdille P, Salse J, Saintenac C, Choulet F, et al. (2008) A physical         21. Schulz MH, Zerbino DR, Vingron M, Birney E (2012) Oases: robust de novo
    map of the 1-gigabase bread wheat chromosome 3B. Science 322: 101–104.                     RNA-seq assembly across the dynamic range of expression levels. Bioinformatics
 3. Kiss I (2 February 2013) SIGNIFICANCE OF WHEAT PRODUCTION IN                               28: 1086–1092.
    WORLD ECONOMY AND POSITION OF HUNGARY IN IT.                                           22. Grabherr MG, Haas BJ, Yassour M, Levin JZ, Thompson DA, et al. (2011) Full-
 4. Brenchley R, Spannagl M, Pfeifer M, Barker GLA, D’Amore R, et al. (2012)                   length transcriptome assembly from RNA-Seq data without a reference genome.
    Analysis of the bread wheat genome using whole-genome shotgun sequencing.                  Nature Biotechnology 29: 644–652.
    Nature 491: 705–710.                                                                   23. Garg R, Patel RK, Jhanwar S, Priya P, Bhattacharjee A, et al. (2011) Gene
 5. Dubcovsky J, Dvorak J (2007) Genome plasticity a key factor in the success of              Discovery and Tissue-Specific Transcriptome Analysis in Chickpea with
    polyploid wheat under domestication. Science 316: 1862-1866.                               Massively Parallel Pyrosequencing and Web Resource Development. Plant
 6. Duan J, Xia C, Zhao G, Jia J, Kong X (2012) Optimizing de novo common                      Physiology 156: 1661–1678.
    wheat transcriptome assembly using short-read RNA-Seq data. BMC Genomics               24. Guo S, Liu J, Zheng Y, Huang M, Zhang H, et al. (2011) Characterization of
    13: 392.                                                                                   transcriptome dynamics during watermelon fruit development: sequencing,
 7. Metzker ML (2010) Sequencing technologies - the next generation. Nat Rev                   assembly, annotation and gene expression profiles. BMC Genomics 12: 454.
    Genet 11: 31–46.                                                                       25. Zhao Q-Y, Wang Y, Kong Y-M, Luo D, Li X, et al. (2011) Optimizing de novo
 8. Wang Z, Gerstein M, Snyder M (2009) RNA-Seq: a revolutionary tool for                      transcriptome assembly from short-read RNA-Seq data: a comparative study.
    transcriptomics. Nature Reviews Genetics 10: 57–63.                                        BMC bioinformatics 12: S2.
 9. Ozsolak F, Milos PM (2011) RNA sequencing: advances, challenges and                    26. Vijay N, Poelstra JW, Kunstner A, Wolf JB (2012) Challenges and strategies in
    opportunities. Nat Rev Genet 12: 87–98.                                                    transcriptome assembly and differential gene expression quantification. A
10. Feng C, Chen M, Xu CJ, Bai L, Yin XR, et al. (2012) Transcriptomic analysis of             comprehensive in silico assessment of RNA-seq experiments. Mol Ecol.
    Chinese bayberry (Myrica rubra) fruit development and ripening using RNA-              27. Sadamoto H (2012) De Novo Sequencing and Transcriptome Analysis of the
    Seq. BMC Genomics 13: 19.                                                                  Central Nervous System of Mollusc Lymnaea stagnalis by Deep RNA
11. Zhang G, Guo G, Hu X, Zhang Y, Li Q, et al. (2010) Deep RNA sequencing at                  Sequencing. PLoS ONE.
    single base-pair resolution reveals high complexity of the rice transcriptome.         28. Jia J, Zhao S, Kong X, Li Y, Zhao G, et al. (2013) Aegilops tauschii draft
    Genome Res 20: 646–654.                                                                    genome sequence reveals a gene repertoire for wheat adaptation. Nature.
12. Ness RW, Siol M, Barrett SC (2011) De novo sequence assembly and                       29. Ling H-Q, Zhao S, Liu D, Wang J, Sun H, et al. (2013) Draft genome of the
    characterization of the floral transcriptome in cross- and self-fertilizing plants.        wheat A-genome progenitor Triticum urartu. Nature.
    BMC Genomics 12: 298.                                                                  30. Xu SB, Li T, Deng ZY, Chong K, Xue Y, et al. (2008) Dynamic Proteomic
13. Bundock PC, Eliott FG, Ablett G, Benson AD, Casu RE, et al. (2009) Targeted                Analysis Reveals a Switch between Central Carbon Metabolism and Alcoholic
    single nucleotide polymorphism (SNP) discovery in a highly polyploid plant                 Fermentation in Rice Filling Grains. Plant Physiology 148: 908–925.
    species using 454 sequencing. Plant Biotechnol J 7: 347–354.                           31. Patel RK (2012) NGS QC Toolkit: A Toolkit for Quality Control of Next
14. Trick M, Adamski NM, Mugford SG, Jiang CC, Febrer M, et al. (2012)                         Generation Sequencing Data. PLoS ONE.
    Combining SNP discovery from next-generation sequencing data with bulked               32. Haznedaroglu BZ (2012) Optimization of de novo transcriptome assembly from
    segregant analysis (BSA) to fine-map genes in polyploid wheat. BMC Plant Biol              high-throughput short read sequencing data improves functiona annotation for
    12: 14.                                                                                    non-model organisms.pdf. BMC bioinformatics.
15. Wilhelm BT, Landry JR (2009) RNA-Seq-quantitative measurement of                       33. Kent WJ (2002) BLAT—the BLAST-like alignment tool. Genome Res 12: 656–
    expression through massively parallel RNA-sequencing. Methods 48: 249–257.                 664.
16. Wang Z (2011) Next-generation transcriptome assembly. Nature Reviews                   34. Kumar S, Blaxter ML (2010) Comparing de novo assemblers for 454
    Genetics 12: 671–682.                                                                      transcriptome data. BMC Genomics 11: 571.
17. Li R, Yu C, Li Y, Lam TW, Yiu SM, et al. (2009) SOAP2: an improved ultrafast           35. Langmead B, Trapnell C, Pop M, Salzberg SL (2009) Ultrafast and memory-
    tool for short read alignment. Bioinformatics 25: 1966–1967.                               efficient alignment of short DNA sequences to the human genome. Genome Biol
18. Simpson JT, Wong K, Jackman SD, Schein JE, Jones SJ, et al. (2009) ABySS: a                10: R25.
    parallel assembler for short read sequence data. Genome Res 19: 1117–1123.
PLOS ONE | www.plosone.org                                                              11                          December 2013 | Volume 8 | Issue 12 | e83530
                                                                                                                 Evaluation of Assembly Strategies Using RNA-Seq
36. Martin J, Bruno VM, Fang Z, Meng X, Blow M, et al. (2010) Rnnotator: an            41. Aird D, Ross MG, Chen WS, Danielsson M, Fennell T, et al. (2011) Analyzing
    automated de novo transcriptome assembly pipeline from stranded RNA-Seq                and minimizing PCR amplification bias in Illumina sequencing libraries.
    reads. BMC Genomics 11: 663.                                                           Genome Biol 12: R18.
37. Mochida K, Yoshida T, Sakurai T, Ogihara Y, Shinozaki K (2009) TriFLDB: a          42. Benjamini Y, Speed TP (2012) Summarizing and correcting the GC content bias
    database of clustered full-length coding sequences from Triticeae with                 in high-throughput sequencing. Nucleic Acids Res 40: e72.
    applications to comparative grass genomics. Plant Physiol 150: 1135–1146.          43. Risso D, Schwartz K, Sherlock G, Dudoit S (2011) GC-Content Normalization
38. Li W, Godzik A (2006) Cd-hit: a fast program for clustering and comparing large        for RNA-Seq Data. BMC bioinformatics 12: 480.
    sets of protein or nucleotide sequences. Bioinformatics 22: 1658–1659.             44. Xu DL, Long H, Liang JJ, Zhang J, Chen X, et al. (2012) De novo assembly and
39. Huang X, Madan A (1999) CAP3: A DNA sequence assembly program.                         characterization of the root transcriptome of Aegilops variabilis during an
    Genome Res 9: 868–877.                                                                 interaction with the cereal cyst nematode. BMC Genomics 13: 133.
40. Trapnell C, Roberts A, Goff L, Pertea G, Kim D, et al. (2012) Differential gene    45. Shi C-Y, Yang H, Wei C-L, Yu O, Zhang Z-Z, et al. (2011) Deep sequencing of
    and transcript expression analysis of RNA-seq experiments with TopHat and              the Camellia sinensis transcriptome revealed candidate genes for major
    Cufflinks. Nature Protocols 7: 562–578.                                                metabolic pathways of tea-specific compounds. BMC Genomics 12: 131.
PLOS ONE | www.plosone.org                                                          12                         December 2013 | Volume 8 | Issue 12 | e83530
